{
    "content": {
        "modulesContent": {
            "$edgeAgent": {
                "properties.desired.modules.LogsCollector": {
                    "settings": {
                        "image": "__IMAGE_REPOSITORY__:__IMAGE_TAG__",
                        "createOptions": {
                            "Env": [
                                "BACKLOG=false",
                                "LOGSPOUT=ignore",
                                "LOGANALYTICS_WORKSPACE_ID=__WORKSPACE_ID__",
                                "LOGANALYTICS_WORKSPACE_SECRET=__WORKSPACE_KEY__"
                            ],
                            "Cmd": [
                                "loganalytics://"
                            ],
                            "HostConfig": {
                                "Binds": [
                                "/var/run/docker.sock:/var/run/docker.sock"
                                ]
                            }
                        }
                    },
                    "type": "docker",
                    "env": {
                        "AzMonWorkspaceId": {
                            "value": "__WORKSPACE_ID__"
                        },
                        "AzMonWorkspaceKey": {
                            "value": "__WORKSPACE_KEY__"
                        }
                    },
                    "status": "running",
                    "restartPolicy": "always",
                    "version": "1.0"
                }
            },
            "$edgeHub": {
                "properties.desired.routes.LogspoutToIoTHub": "FROM /messages/modules/LogsCollector/* INTO $upstream"
            },
            "LogsCollector": {
                "properties.desired": {
                    "schemaVersion": "1.0",
                    "scrapeFrequencySecs": 300,
                    "metricsFormat": "Json",
                    "syncTarget": "IoTHub",
                    "endpoints": {
                        "edgeHub": "http://edgeHub:9600/metrics"
                    }
                }
            }
        }
    }
}
